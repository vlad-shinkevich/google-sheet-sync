# Как использовать Excel to Figma Sync

## Быстрый старт

### Шаг 1: Подготовьте Excel файл

Создайте Excel файл (.xlsx) со следующей структурой:

- **Первая строка** - заголовки колонок (названия полей)
- **Остальные строки** - данные

Пример:

| Title | Description | Image | Color |
|-------|-------------|-------|-------|
| Карточка 1 | Описание первой карточки | https://example.com/image1.jpg | #FF5733 |
| Карточка 2 | Описание второй карточки | https://example.com/image2.jpg | #33FF57 |

### Шаг 2: Настройте слои в Figma

Назовите слои в вашем шаблоне, добавив `#` перед названием колонки из Excel:

```
Frame: Шаблон карточки
├── Text: #Title
├── Text: #Description
├── Rectangle: #Image
└── Rectangle: #Color
```

**Примечание:** 
- Регистр не имеет значения (`#title` = `#Title`)
- Пробелы игнорируются (`#my title` = `#MyTitle`)

### Шаг 3: Запустите плагин

1. Выберите фрейм который будет использоваться как шаблон
2. Запустите плагин "Excel to Figma Sync"
3. Перетащите ваш Excel файл в зону загрузки (или нажмите чтобы выбрать)
4. Выберите строки которые хотите синхронизировать
5. Нажмите кнопку "Sync to Figma"

Плагин создаст копии вашего шаблона и заполнит их данными из выбранных строк.

## Поддерживаемые типы данных

### Текст
Простой текст будет вставлен в текстовые слои:
```
Любой текст
```

### Изображения
URL изображений будут загружены и применены к фреймам/фигурам:
```
https://example.com/image.jpg
https://picsum.photos/200/300
https://images.unsplash.com/photo-xxx
https://lh3.googleusercontent.com/...
```

Поддерживаемые форматы: PNG, JPG, GIF, WebP, SVG

**Примечание:** Плагин автоматически обрабатывает CORS ограничения через прокси. Если изображение с каких-то доменов (например, Google Drive) не загружается напрямую, плагин попробует загрузить его через CORS прокси.

### Цвета
Hex коды цветов будут применены к заливке:
```
#FF5733
#33FF57
#3357FF
```

### Варианты компонентов
Для смены вариантов компонента используйте формат `Property=Value, Property2=Value2` (через запятую с пробелом):
```
Type=Primary, Size=Large, State=Default, Icon=True
Size=Large, Color=Blue
```

**Важно:** 
- Используйте запятые с пробелами между свойствами
- Указывайте ВСЕ свойства варианта, не только некоторые
- Соблюдайте правильный порядок свойств (как они определены в Figma)

### Ссылки
URL будут применены как гиперссылки к текстовым слоям:
```
https://example.com
```

### Видимость
Управление видимостью слоев:
```
/show    # Показать слой
/hide    # Скрыть слой
```

### Цвет для текста
Применить цвет к текстовому слою (требуется префикс `/`):
```
/#FF5733
```

## Советы

### 1. Организация данных
- Держите заголовки простыми и понятными
- Используйте одинаковые названия в Excel и Figma
- Один шаблон = одна строка данных

### 2. Работа с изображениями
- Используйте прямые ссылки на изображения
- Поддерживаются изображения с любых источников (Google Drive, Unsplash, прямые URL и т.д.)
- Плагин автоматически обходит CORS ограничения через прокси сервис
- Для локальных изображений загрузите их в облако (Cloudinary, Imgur, Google Drive и т.д.)

### 3. Оптимизация
- Выбирайте только те строки которые нужно синхронизировать
- Создайте несколько шаблонов для разных типов контента
- Используйте Auto Layout для адаптивности

### 4. Отладка
- Проверьте что названия слоев совпадают с заголовками Excel (регистр неважен)
- Убедитесь что слои не заблокированы
- Проверьте консоль на наличие ошибок

## Примеры использования

### Пример 1: Карточки продуктов

**Excel:**
| Name | Price | Image | Rating |
|------|-------|-------|--------|
| iPhone 15 | $999 | https://... | ⭐⭐⭐⭐⭐ |
| MacBook Pro | $2499 | https://... | ⭐⭐⭐⭐⭐ |

**Figma:**
```
Frame: #ProductCard
├── Text: #Name
├── Text: #Price
├── Rectangle: #Image
└── Text: #Rating
```

### Пример 2: Профили пользователей

**Excel:**
| Name | Email | Avatar | Status |
|------|-------|--------|--------|
| John Doe | john@example.com | https://... | /show |
| Jane Smith | jane@example.com | https://... | /hide |

**Figma:**
```
Frame: #UserProfile
├── Text: #Name
├── Text: #Email
├── Rectangle: #Avatar
└── Badge: #Status (этот слой будет показан/скрыт)
```

### Пример 3: Кнопки с вариантами

**Excel:**
| Label | Variant | Color |
|-------|---------|-------|
| Submit | Type=Primary, Size=Large, State=Default | #007AFF |
| Cancel | Type=Secondary, Size=Medium, State=Default | #FF3B30 |

**Figma:**
```
Frame: #ButtonTemplate
├── Component Instance: #Variant
│   (с вариантами: Type, Size, State)
└── Rectangle: #Color
```

**Примечание:** Формат вариантов должен включать ВСЕ свойства через запятую: `Property=Value, Property=Value`

## Частые вопросы

**Q: Можно ли использовать несколько вкладок в Excel?**  
A: Пока нет, используется только первая вкладка. Создайте отдельные файлы для разных наборов данных.

**Q: Что делать если изображение не загружается?**  
A: Проверьте что URL правильный и изображение доступно. Попробуйте открыть URL в браузере.

**Q: Как обновить существующие карточки?**  
A: Удалите старые карточки и запустите синхронизацию заново.

**Q: Можно ли синхронизировать в существующие фреймы?**  
A: Нет, плагин создает новые копии шаблона. Это предотвращает случайную перезапись данных.

**Q: Поддерживаются ли формулы в Excel?**  
A: Да, используется вычисленное значение формулы.

